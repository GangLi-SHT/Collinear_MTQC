Mat2P = {'P':[[1,0,0],[0,1,0],[0,0,1]],
         'C':[[0.5,0.5,0.0],[-0.5,0.5,0.0],[0.0,0.0,1.0]],
         'B':[[0.5,0.0,-0.5],[0.0,1.0,0.0],[0.5,0.0,0.5]],
         'A':[[1.0,0.0,0.0],[0.0,0.5,-0.5],[0.0,0.5,0.5]],
         'R':[[2/3,-1/3,-1/3],[1/3,1/3,-2/3],[1/3,1/3,1/3]],
         'I':[[-0.5,0.5,0.5],[0.5,-0.5,0.5],[0.5,0.5,-0.5]],
         'F':[[0.0,0.5,0.5],[0.5,0.0,0.5],[0.5,0.5,0.0]]
        }

# numbers of spacegroups which has ambiguities of cell conventions in BCS settings
SG_ambi =  [16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 32, 34, 35, 37, 42, 43,
            44, 45, 47, 48, 49, 50, 55, 56, 58, 59, 61, 65, 66, 67, 69, 70, 71,
            72, 73, 74]

permu_mat_orthorhombic = [[[-1, 0, 0], [0, 0, 1], [0, 1, 0]],
            [[0, -1, 0], [1, 0, 0], [0, 0, 1]],
            [[0, 1, 0], [0, 0, 1], [1, 0, 0]],
            [[0, 0, 1], [1, 0, 0], [0, 1, 0]],
            [[0, 0, -1], [0, 1, 0], [1, 0, 0]]]

permutation_orthorhombic  = [[0, 1, 2, 3, 4],
                 [1],
                 [1],
                 [0, 1, 2, 3, 4],
                 [1],
                 [1],
                 [0, 1, 2, 3, 4],
                 [0, 1, 2, 3, 4],
                 [0, 1, 2, 3, 4],
                 [1],
                 [1],
                 [1],
                 [1],
                 [1],
                 [1],
                 [1],
                 [1],
                 [1],
                 [1],
                 [0, 1, 2, 3, 4],
                 [0, 1, 2, 3, 4],
                 [1],
                 [1],
                 [1],
                 [1],
                 [1],
                 [1],
                 [2, 3],
                 [1],
                 [1],
                 [1],
                 [0, 1, 2, 3, 4],
                 [2, 3],
                 [0, 1, 2, 3, 4],
                 [1],
                 [0, 1, 2, 3, 4],
                 [1]]

origin_shift_orthorhombic = [[[0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.25]],
                 [[0.0, 0.0, 0.0]],
                 [[0.25, -0.25, 0.25],
                  [0.25, -0.25, 0.25],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.25, -0.25, 0.25]],
                 [[0.0, 0.0, 0.25]],
                 [[0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0]],
                 [[-0.25, 0.25, 0.25],
                  [-0.25, 0.25, 0.25],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [-0.25, 0.25, 0.25]],
                 [[0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0]],
                 [[-0.25, -0.25, -0.5]],
                 [[0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0]],
                 [[0.25, -0.25, 0.0]],
                 [[0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0]],
                 [[0.0, 0.0, 0.0]],
                 [[-0.25, 0.25, 0.25],
                  [-0.25, 0.25, 0.25],
                  [0.0, 0.0, 0.0],
                  [0.0, 0.0, 0.0],
                  [-0.25, 0.25, 0.25]],
                 [[-0.25, 0.25, 0.25]]]

permutation_monoclinic= [[0, 1, 2, 3, 4],
                         [0, 1, 2, 3, 4],
                         [0],
                         [0, 1, 2, 3, 4],
                         [1],
                         [0],
                         [0],
                         [0, 1, 2, 3, 4],
                         [0, 1, 2, 3, 4],
                         [0],
                         [1],
                         [1],
                         [0]]
permu_mat_monoclinic = [[[1,0,0],[0,1,0],[1,0,1]], 
                        [[1,0,1],[0,1,0],[0,0,1]],
                        [[0,0,1],[0,1,0],[-1,0,0]],
                        [[1,0,1],[0,1,0],[-1,0,0]],
                        [[0,0,1],[0,1,0],[-1,0,-1]]]
origin_shift_monoclinic =[[[0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0]],
                         [[0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0]],
                         [[0.0, 0.0, 0.0]],
                         [[0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0]],
                         [[0.0, 0.0, 0.0]],
                         [[0.0, 0.0, 0.0]],
                         [[-0.25, 0.25, 0.0]],
                         [[0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0]],
                         [[0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0],
                          [0.0, 0.0, 0.0]],
                         [[0.0, 0.0, 0.0]],
                         [[0.0, 0.0, 0.0]],
                         [[0.0, 0.0, 0.0]],
                         [[-0.25, 0.25, 0.0]]]

